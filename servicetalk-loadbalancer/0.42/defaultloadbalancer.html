<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ServiceTalks default Load Balancer :: ServiceTalk Docs</title>
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" href="../../_/css/site.css">
<meta name="description" content="ServiceTalk is a JVM network application framework with APIs tailored to specific protocols (e.g. HTTP/1.x, HTTP/2.x, etc…​) and supports multiple programming paradigms.">
<meta name="keywords" content="servicetalk, java, reactive, reactive-streams, microservices, framework, http, http2, rpc, grpc, netty">
<link rel="stylesheet" href="../../_/css/site-extra.css">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-151504011-1"></script>
<script>function gtag(){dataLayer.push(arguments)};window.dataLayer=window.dataLayer||[];gtag('js',new Date());gtag('config','UA-151504011-1')</script>
    <link rel="icon" href="../../favicon.ico" type="image/x-icon">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <div class="navbar-item">
        <a href="https://github.com/apple/servicetalk">
          <img class="navbar-logo" src="../../_/img/servicetalk.png" alt="ServiceTalk logo" />
          <span>ServiceTalk</span>
        </a>
        <span class="separator">//</span>
        <a href="../..">Docs</a>
      </div>
    </div>
  </nav>
</header>
<div class="main-wrapper">
    <div class="navigation-container"
      data-component="servicetalk-loadbalancer" data-version="0.42">
    <aside class="navigation">
        <div class="panels">
            <div class="navigation-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html">Load Balancing</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <span class="nav-text">Concepts</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../servicetalk/0.42/programming-paradigms.html">Programming Paradigms</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../servicetalk/0.42/blocking-safe-by-default.html">Blocking safe by default</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../servicetalk/0.42/evolve-to-async.html">Evolving to asynchronous</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../servicetalk/0.42/async-context.html">Asynchronous Context</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../servicetalk/0.42/performance.html">Performance</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <span class="nav-text">Examples</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../../servicetalk-examples/0.42/http/index.html">HTTP</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/0.42/http/index.html#HelloWorld">Hello World</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/0.42/http/index.html#Compression">Compression</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/0.42/http/index.html#Debugging">Debugging</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/0.42/http/index.html#Timeout">Timeout</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/0.42/http/index.html#SerializationJson">Serialization: JSON</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/0.42/http/index.html#SerializationProtobuf">Serialization: Protobuf</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/0.42/http/index.html#SerializationBytes">Serialization: Bytes</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/0.42/http/index.html#JAXRS">JAX-RS</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/0.42/http/index.html#MetaData">MetaData</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/0.42/http/index.html#HTTP2">HTTP/2</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/0.42/http/index.html#Mutual-TLS">Mutual TLS</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/0.42/http/index.html#Observer">Observer</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/0.42/http/index.html#LoadBalancer">LoadBalancer</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/0.42/http/index.html#OpenTracing">OpenTracing</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/0.42/http/index.html#OpenTelemetryTracing">OpenTelemetry Tracing</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/0.42/http/index.html#Redirects">Redirects</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/0.42/http/index.html#Retries">Retries</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/0.42/http/index.html#uds">Unix Domain Sockets</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/0.42/http/index.html#Files">Files</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/0.42/http/service-composition.html">Service Composition</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../../servicetalk-examples/0.42/grpc/index.html">gRPC</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/0.42/grpc/index.html#HelloWorld">Hello World</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/0.42/grpc/index.html#Compression">Compression</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/0.42/grpc/index.html#Deadlines">Deadlines</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/0.42/grpc/index.html#KeepAlive">Keep Alive</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/0.42/grpc/index.html#Observer">Observer</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/0.42/grpc/index.html#Health">Health Checking</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/0.42/grpc/index.html#errors">Application Errors</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/0.42/grpc/index.html#execution-strategy">Execution Strategy</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/0.42/grpc/index.html#route-guide">Route Guide</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/0.42/grpc/index.html#protoc-options">Protoc Options</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/0.42/grpc/index.html#request-response-context">Request Response Context</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <span class="nav-text">Concurrent API</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../servicetalk-concurrent-api/0.42/asynchronous-primitives.html">Asynchronous Primitives</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../../servicetalk-concurrent-api/0.42/blocking-safe-by-default.html">Blocking Safe by Default</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-concurrent-api/0.42/blocking-implementation.html">Implementation Details</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../servicetalk-concurrent-api/0.42/async-context.html">Asynchronous Context</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../servicetalk-concurrent-api/0.42/pitfalls.html">Concurrency Pitfalls</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../../servicetalk-http-api/0.42/index.html">HTTP</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../servicetalk-http-api/0.42/programming-paradigms.html">Programming paradigms</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../servicetalk-http-api/0.42/blocking-safe-by-default.html">Blocking safe by default</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../servicetalk-http-api/0.42/evolve-to-async.html">Evolving to asynchronous</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../../servicetalk-http-router-jersey/0.42/index.html">JAX-RS Router (Jersey)</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-http-router-jersey/0.42/evolve-to-async.html">Evolving to asynchronous</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-http-security-jersey/0.42/index.html">Security</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-data-jackson-jersey/0.42/index.html">JSON (Jackson)</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../servicetalk-grpc-api/0.42/index.html">gRPC</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="index.html">Load Balancing</a>
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="defaultloadbalancer.html">Default Load Balancer</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../servicetalk-client-api/0.42/service-discovery.html">Service Discovery</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <span class="nav-text">Traffic Resiliency</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../servicetalk-traffic-resilience-http/0.42/index.html">Resilience Concepts</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../servicetalk-traffic-resilience-http/0.42/traffic-resilience-features.html">Resilience Features</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <span class="nav-text">Observability</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../servicetalk-opentelemetry-http/0.42/index.html">OpenTelemetry Tracing</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../servicetalk/0.42/javadoc/index.html">Javadoc</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../servicetalk/0.42/contributing.html">Contributing</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
            <div class="navigation-explore" data-panel="explore">
  <div class="context">
    <span class="title">Load Balancing</span>
    <span class="version">0.42</span>
  </div>
  <ul class="components">
    <li class="component">
      <span class="title">Client API</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../servicetalk-client-api/SNAPSHOT/index.html">SNAPSHOT</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-client-api/0.42/index.html">0.42</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-client-api/0.41/index.html">0.41</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-client-api/0.40/index.html">0.40</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-client-api/0.39/index.html">0.39</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-client-api/0.38/index.html">0.38</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-client-api/0.37/index.html">0.37</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-client-api/0.36/index.html">0.36</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-client-api/0.35/index.html">0.35</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-client-api/0.34/index.html">0.34</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-client-api/0.33/index.html">0.33</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-client-api/0.32/index.html">0.32</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-client-api/0.31/index.html">0.31</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-client-api/0.30/index.html">0.30</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-client-api/0.29/index.html">0.29</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-client-api/0.28/index.html">0.28</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-client-api/0.27/index.html">0.27</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-client-api/0.26/index.html">0.26</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-client-api/0.25/index.html">0.25</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Concurrent API</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../servicetalk-concurrent-api/SNAPSHOT/index.html">SNAPSHOT</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-concurrent-api/0.42/index.html">0.42</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-concurrent-api/0.41/index.html">0.41</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-concurrent-api/0.40/index.html">0.40</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-concurrent-api/0.39/index.html">0.39</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-concurrent-api/0.38/index.html">0.38</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-concurrent-api/0.37/index.html">0.37</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-concurrent-api/0.36/index.html">0.36</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-concurrent-api/0.35/index.html">0.35</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-concurrent-api/0.34/index.html">0.34</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-concurrent-api/0.33/index.html">0.33</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-concurrent-api/0.32/index.html">0.32</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-concurrent-api/0.31/index.html">0.31</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-concurrent-api/0.30/index.html">0.30</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-concurrent-api/0.29/index.html">0.29</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-concurrent-api/0.28/index.html">0.28</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-concurrent-api/0.27/index.html">0.27</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-concurrent-api/0.26/index.html">0.26</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-concurrent-api/0.25/index.html">0.25</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-concurrent-api/0.24/index.html">0.24</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-concurrent-api/0.23/index.html">0.23</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-concurrent-api/0.22/index.html">0.22</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-concurrent-api/0.21/index.html">0.21</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-concurrent-api/0.20/index.html">0.20</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-concurrent-api/0.19/index.html">0.19</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Examples</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../servicetalk-examples/SNAPSHOT/index.html">SNAPSHOT</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-examples/0.42/index.html">0.42</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-examples/0.41/index.html">0.41</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-examples/0.40/index.html">0.40</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-examples/0.39/index.html">0.39</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-examples/0.38/index.html">0.38</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-examples/0.37/index.html">0.37</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-examples/0.36/index.html">0.36</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-examples/0.35/index.html">0.35</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-examples/0.34/index.html">0.34</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-examples/0.33/index.html">0.33</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-examples/0.32/index.html">0.32</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-examples/0.31/index.html">0.31</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-examples/0.30/index.html">0.30</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-examples/0.29/index.html">0.29</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-examples/0.28/index.html">0.28</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-examples/0.27/index.html">0.27</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-examples/0.26/index.html">0.26</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-examples/0.25/index.html">0.25</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-examples/0.24/index.html">0.24</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-examples/0.23/index.html">0.23</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-examples/0.22/index.html">0.22</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-examples/0.21/index.html">0.21</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-examples/0.20/index.html">0.20</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-examples/0.19/index.html">0.19</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">gRPC</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../servicetalk-grpc-api/SNAPSHOT/index.html">SNAPSHOT</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-grpc-api/0.42/index.html">0.42</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-grpc-api/0.41/index.html">0.41</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-grpc-api/0.40/index.html">0.40</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-grpc-api/0.39/index.html">0.39</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-grpc-api/0.38/index.html">0.38</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-grpc-api/0.37/index.html">0.37</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-grpc-api/0.36/index.html">0.36</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-grpc-api/0.35/index.html">0.35</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-grpc-api/0.34/index.html">0.34</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-grpc-api/0.33/index.html">0.33</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-grpc-api/0.32/index.html">0.32</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-grpc-api/0.31/index.html">0.31</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-grpc-api/0.30/index.html">0.30</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-grpc-api/0.29/index.html">0.29</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-grpc-api/0.28/index.html">0.28</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-grpc-api/0.27/index.html">0.27</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-grpc-api/0.26/index.html">0.26</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-grpc-api/0.25/index.html">0.25</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-grpc-api/0.24/index.html">0.24</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-grpc-api/0.23/index.html">0.23</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-grpc-api/0.22/index.html">0.22</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-grpc-api/0.21/index.html">0.21</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-grpc-api/0.20/index.html">0.20</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-grpc-api/0.19/index.html">0.19</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">HTTP</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../servicetalk-http-api/SNAPSHOT/index.html">SNAPSHOT</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-api/0.42/index.html">0.42</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-api/0.41/index.html">0.41</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-api/0.40/index.html">0.40</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-api/0.39/index.html">0.39</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-api/0.38/index.html">0.38</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-api/0.37/index.html">0.37</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-api/0.36/index.html">0.36</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-api/0.35/index.html">0.35</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-api/0.34/index.html">0.34</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-api/0.33/index.html">0.33</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-api/0.32/index.html">0.32</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-api/0.31/index.html">0.31</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-api/0.30/index.html">0.30</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-api/0.29/index.html">0.29</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-api/0.28/index.html">0.28</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-api/0.27/index.html">0.27</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-api/0.26/index.html">0.26</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-api/0.25/index.html">0.25</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-api/0.24/index.html">0.24</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-api/0.23/index.html">0.23</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-api/0.22/index.html">0.22</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-api/0.21/index.html">0.21</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-api/0.20/index.html">0.20</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-api/0.19/index.html">0.19</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">JAX-RS Router (Jersey)</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../servicetalk-http-router-jersey/SNAPSHOT/index.html">SNAPSHOT</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-router-jersey/0.42/index.html">0.42</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-router-jersey/0.41/index.html">0.41</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-router-jersey/0.40/index.html">0.40</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-router-jersey/0.39/index.html">0.39</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-router-jersey/0.38/index.html">0.38</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-router-jersey/0.37/index.html">0.37</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-router-jersey/0.36/index.html">0.36</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-router-jersey/0.35/index.html">0.35</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-router-jersey/0.34/index.html">0.34</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-router-jersey/0.33/index.html">0.33</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-router-jersey/0.32/index.html">0.32</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-router-jersey/0.31/index.html">0.31</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-router-jersey/0.30/index.html">0.30</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-router-jersey/0.29/index.html">0.29</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-router-jersey/0.28/index.html">0.28</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-router-jersey/0.27/index.html">0.27</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-router-jersey/0.26/index.html">0.26</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-router-jersey/0.25/index.html">0.25</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-router-jersey/0.24/index.html">0.24</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-router-jersey/0.23/index.html">0.23</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-router-jersey/0.22/index.html">0.22</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-router-jersey/0.21/index.html">0.21</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-router-jersey/0.20/index.html">0.20</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-router-jersey/0.19/index.html">0.19</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">JSON (Jackson)</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../servicetalk-data-jackson-jersey/SNAPSHOT/index.html">SNAPSHOT</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-data-jackson-jersey/0.42/index.html">0.42</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-data-jackson-jersey/0.41/index.html">0.41</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-data-jackson-jersey/0.40/index.html">0.40</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-data-jackson-jersey/0.39/index.html">0.39</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-data-jackson-jersey/0.38/index.html">0.38</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-data-jackson-jersey/0.37/index.html">0.37</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-data-jackson-jersey/0.36/index.html">0.36</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-data-jackson-jersey/0.35/index.html">0.35</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-data-jackson-jersey/0.34/index.html">0.34</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-data-jackson-jersey/0.33/index.html">0.33</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-data-jackson-jersey/0.32/index.html">0.32</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-data-jackson-jersey/0.31/index.html">0.31</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-data-jackson-jersey/0.30/index.html">0.30</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-data-jackson-jersey/0.29/index.html">0.29</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-data-jackson-jersey/0.28/index.html">0.28</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-data-jackson-jersey/0.27/index.html">0.27</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-data-jackson-jersey/0.26/index.html">0.26</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-data-jackson-jersey/0.25/index.html">0.25</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-data-jackson-jersey/0.24/index.html">0.24</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-data-jackson-jersey/0.23/index.html">0.23</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-data-jackson-jersey/0.22/index.html">0.22</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-data-jackson-jersey/0.21/index.html">0.21</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-data-jackson-jersey/0.20/index.html">0.20</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-data-jackson-jersey/0.19/index.html">0.19</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <span class="title">Load Balancing</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../SNAPSHOT/index.html">SNAPSHOT</a>
        </li>
        <li class="version is-current">
          <a href="index.html">0.42</a>
        </li>
        <li class="version">
          <a href="../0.41/index.html">0.41</a>
        </li>
        <li class="version">
          <a href="../0.40/index.html">0.40</a>
        </li>
        <li class="version">
          <a href="../0.39/index.html">0.39</a>
        </li>
        <li class="version">
          <a href="../0.38/index.html">0.38</a>
        </li>
        <li class="version">
          <a href="../0.37/index.html">0.37</a>
        </li>
        <li class="version">
          <a href="../0.36/index.html">0.36</a>
        </li>
        <li class="version">
          <a href="../0.35/index.html">0.35</a>
        </li>
        <li class="version">
          <a href="../0.34/index.html">0.34</a>
        </li>
        <li class="version">
          <a href="../0.33/index.html">0.33</a>
        </li>
        <li class="version">
          <a href="../0.32/index.html">0.32</a>
        </li>
        <li class="version">
          <a href="../0.31/index.html">0.31</a>
        </li>
        <li class="version">
          <a href="../0.30/index.html">0.30</a>
        </li>
        <li class="version">
          <a href="../0.29/index.html">0.29</a>
        </li>
        <li class="version">
          <a href="../0.28/index.html">0.28</a>
        </li>
        <li class="version">
          <a href="../0.27/index.html">0.27</a>
        </li>
        <li class="version">
          <a href="../0.26/index.html">0.26</a>
        </li>
        <li class="version">
          <a href="../0.25/index.html">0.25</a>
        </li>
        <li class="version">
          <a href="../0.24/index.html">0.24</a>
        </li>
        <li class="version">
          <a href="../0.23/index.html">0.23</a>
        </li>
        <li class="version">
          <a href="../0.22/index.html">0.22</a>
        </li>
        <li class="version">
          <a href="../0.21/index.html">0.21</a>
        </li>
        <li class="version">
          <a href="../0.20/index.html">0.20</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">OpenTelemetry</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../servicetalk-opentelemetry-http/SNAPSHOT/index.html">SNAPSHOT</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-opentelemetry-http/0.42/index.html">0.42</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Security</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../servicetalk-http-security-jersey/SNAPSHOT/index.html">SNAPSHOT</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-security-jersey/0.42/index.html">0.42</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-security-jersey/0.41/index.html">0.41</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-security-jersey/0.40/index.html">0.40</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-security-jersey/0.39/index.html">0.39</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-security-jersey/0.38/index.html">0.38</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-security-jersey/0.37/index.html">0.37</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-security-jersey/0.36/index.html">0.36</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-security-jersey/0.35/index.html">0.35</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-security-jersey/0.34/index.html">0.34</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-security-jersey/0.33/index.html">0.33</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-security-jersey/0.32/index.html">0.32</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-security-jersey/0.31/index.html">0.31</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-security-jersey/0.30/index.html">0.30</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-security-jersey/0.29/index.html">0.29</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-security-jersey/0.28/index.html">0.28</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-security-jersey/0.27/index.html">0.27</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-security-jersey/0.26/index.html">0.26</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-security-jersey/0.25/index.html">0.25</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-security-jersey/0.24/index.html">0.24</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-security-jersey/0.23/index.html">0.23</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-security-jersey/0.22/index.html">0.22</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-security-jersey/0.21/index.html">0.21</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-security-jersey/0.20/index.html">0.20</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-security-jersey/0.19/index.html">0.19</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">ServiceTalk</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../servicetalk/SNAPSHOT/index.html">SNAPSHOT</a>
        </li>
        <li class="version">
          <a href="../../servicetalk/0.42/index.html">0.42</a>
        </li>
        <li class="version">
          <a href="../../servicetalk/0.41/index.html">0.41</a>
        </li>
        <li class="version">
          <a href="../../servicetalk/0.40/index.html">0.40</a>
        </li>
        <li class="version">
          <a href="../../servicetalk/0.39/index.html">0.39</a>
        </li>
        <li class="version">
          <a href="../../servicetalk/0.38/index.html">0.38</a>
        </li>
        <li class="version">
          <a href="../../servicetalk/0.37/index.html">0.37</a>
        </li>
        <li class="version">
          <a href="../../servicetalk/0.36/index.html">0.36</a>
        </li>
        <li class="version">
          <a href="../../servicetalk/0.35/index.html">0.35</a>
        </li>
        <li class="version">
          <a href="../../servicetalk/0.34/index.html">0.34</a>
        </li>
        <li class="version">
          <a href="../../servicetalk/0.33/index.html">0.33</a>
        </li>
        <li class="version">
          <a href="../../servicetalk/0.32/index.html">0.32</a>
        </li>
        <li class="version">
          <a href="../../servicetalk/0.31/index.html">0.31</a>
        </li>
        <li class="version">
          <a href="../../servicetalk/0.30/index.html">0.30</a>
        </li>
        <li class="version">
          <a href="../../servicetalk/0.29/index.html">0.29</a>
        </li>
        <li class="version">
          <a href="../../servicetalk/0.28/index.html">0.28</a>
        </li>
        <li class="version">
          <a href="../../servicetalk/0.27/index.html">0.27</a>
        </li>
        <li class="version">
          <a href="../../servicetalk/0.26/index.html">0.26</a>
        </li>
        <li class="version">
          <a href="../../servicetalk/0.25/index.html">0.25</a>
        </li>
        <li class="version">
          <a href="../../servicetalk/0.24/index.html">0.24</a>
        </li>
        <li class="version">
          <a href="../../servicetalk/0.23/index.html">0.23</a>
        </li>
        <li class="version">
          <a href="../../servicetalk/0.22/index.html">0.22</a>
        </li>
        <li class="version">
          <a href="../../servicetalk/0.21/index.html">0.21</a>
        </li>
        <li class="version">
          <a href="../../servicetalk/0.20/index.html">0.20</a>
        </li>
        <li class="version">
          <a href="../../servicetalk/0.19/index.html">0.19</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Traffic Resilience</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../servicetalk-traffic-resilience-http/SNAPSHOT/index.html">SNAPSHOT</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-traffic-resilience-http/0.42/index.html">0.42</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
        </div>
    </aside>
</div>
    <main class="main">
        <div class="toolbar" role="navigation">
  <button class="navigation-toggle"></button>
  <a href="../../servicetalk/SNAPSHOT/index.html" class="home-link"></a>
<nav class="crumbs" aria-label="breadcrumbs">
        <ul>
                <li class="crumb"><a href="index.html">Load Balancing</a></li>
                <li class="crumb"><a href="defaultloadbalancer.html">Default Load Balancer</a></li>
        </ul>
</nav>
<div class="page-versions">
  <button class="versions-menu-toggle" title="Show other versions of page">0.42</button>
  <div class="versions-menu">
    <a class="version" href="../SNAPSHOT/defaultloadbalancer.html">SNAPSHOT</a>
    <a class="version is-current" href="defaultloadbalancer.html">0.42</a>
    <a class="version is-missing" href="../0.41/index.html">0.41</a>
    <a class="version is-missing" href="../0.40/index.html">0.40</a>
    <a class="version is-missing" href="../0.39/index.html">0.39</a>
    <a class="version is-missing" href="../0.38/index.html">0.38</a>
    <a class="version is-missing" href="../0.37/index.html">0.37</a>
    <a class="version is-missing" href="../0.36/index.html">0.36</a>
    <a class="version is-missing" href="../0.35/index.html">0.35</a>
    <a class="version is-missing" href="../0.34/index.html">0.34</a>
    <a class="version is-missing" href="../0.33/index.html">0.33</a>
    <a class="version is-missing" href="../0.32/index.html">0.32</a>
    <a class="version is-missing" href="../0.31/index.html">0.31</a>
    <a class="version is-missing" href="../0.30/index.html">0.30</a>
    <a class="version is-missing" href="../0.29/index.html">0.29</a>
    <a class="version is-missing" href="../0.28/index.html">0.28</a>
    <a class="version is-missing" href="../0.27/index.html">0.27</a>
    <a class="version is-missing" href="../0.26/index.html">0.26</a>
    <a class="version is-missing" href="../0.25/index.html">0.25</a>
    <a class="version is-missing" href="../0.24/index.html">0.24</a>
    <a class="version is-missing" href="../0.23/index.html">0.23</a>
    <a class="version is-missing" href="../0.22/index.html">0.22</a>
    <a class="version is-missing" href="../0.21/index.html">0.21</a>
    <a class="version is-missing" href="../0.20/index.html">0.20</a>
  </div>
</div>
</div>
        <article class="doc">
<h1>ServiceTalks default Load Balancer</h1>
<div class="sect1">
<h2 id="what-is-the-default-load-balancer"><a class="anchor" href="#what-is-the-default-load-balancer"></a><a class="link" href="#what-is-the-default-load-balancer">What is the default Load Balancer?</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The default load balancer is a refactor and generalization of the ServiceTalk Round-Robin load balancer that is intended
to provide a more flexible foundation for building load balancers. It serves as the basis for new features that were not
possible with RoundRobinLoadBalancer including host scoring, additional selection algorithms, and outlier detectors.</p>
</div>
<div class="sect2">
<h3 id="relationship-between-the-loadbalancer-and-connections"><a class="anchor" href="#relationship-between-the-loadbalancer-and-connections"></a><a class="link" href="#relationship-between-the-loadbalancer-and-connections">Relationship Between the LoadBalancer and Connections</a></h3>
<div class="paragraph">
<p>The load balancer is structured as a series of hosts and those hosts can have many connections. The number of
connections to each host is driven by the number of connections  required to satisfy the request load. Usage of the
HTTP/2 protocol will dramatically shrink the necessary number of connections to each backend, often to 1, and is
strongly encouraged.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="_images/flowdiagram.png" alt="Abstraction Relationships">
</div>
</div>
</div>
<div class="sect2">
<h3 id="more-host-selection-algorithms"><a class="anchor" href="#more-host-selection-algorithms"></a><a class="link" href="#more-host-selection-algorithms">More Host Selection Algorithms</a></h3>
<div class="paragraph">
<p>A primary goal of the default load balancer was to open the door to alternative host selection algorithms. The
round-robin load balancer is limited to round-robin while the default load balancer comes out of the box with multiple
choices and the flexibility to add more if necessary.</p>
</div>
<div class="sect3">
<h4 id="power-of-two-choices-p2c"><a class="anchor" href="#power-of-two-choices-p2c"></a><a class="link" href="#power-of-two-choices-p2c">Power of two Choices (P2C)</a></h4>
<div class="paragraph">
<p>Power of two choices (<a href="https://doi.org/10.1109/71.963420">P2C</a>) is an algorithm that allows load balancers to
bias traffic toward hosts with a better 'score' while retaining the fairness of random selection. This algorithm is
a random selection process but with a twist: it selects two hosts at random and from those two pick the 'best' where
best is defined by a scoring system. ServiceTalk uses an Exponentially Weighted Moving Average
(<a href="http://www.eckner.com/papers/Algorithms%20for%20Unevenly%20Spaced%20Time%20Series.pdf">EWMA</a>) scoring system by default.
EWMA takes into account the recent latency, failures, and outstanding request load of the destination host when
computing a hosts score.</p>
</div>
<div class="paragraph">
<p>The P2C selection algorithm has a number of favorable properties</p>
</div>
<div class="ulist">
<ul>
<li>
<p>having significantly more fair request distribution between hosts than simple random</p>
</li>
<li>
<p>biasing away from low performing hosts</p>
</li>
<li>
<p>avoiding the order coalescing problems associated with round-robin</p>
</li>
</ul>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="_images/p2cdiagram.png" alt="P2C Endpoint Selection" width="300">
</div>
</div>
</div>
<div class="sect3">
<h4 id="round-robin"><a class="anchor" href="#round-robin"></a><a class="link" href="#round-robin">Round-Robin</a></h4>
<div class="paragraph">
<p>While round-robin is a very common algorithm that is easy to understand. From a local perspective it is an extremely
fair algorithm assuming each request is essentially the same cost. It&#8217;s downsides include unwanted correlation effects
due to its sequential ordering and inability to modulate traffic to hosts other than in the case of outright host
failure.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="_images/roundrobindiagram.png" alt="Round" width="300">
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="xds-outlier-detection"><a class="anchor" href="#xds-outlier-detection"></a><a class="link" href="#xds-outlier-detection">xDS Outlier Detection</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="what-is-xds"><a class="anchor" href="#what-is-xds"></a><a class="link" href="#what-is-xds">What is xDS</a></h3>
<div class="paragraph">
<p>In addition to being more modular default load balancer is being introduced with resiliency features found in the xDS
specification that was pioneered by the Envoy project and is being <a href="https://github.com/cncf/xds">advanced by the CNCF</a>.
xDS defines a control plane that allows for the distributed configuration of key components like certificates,
load balancers, etc. In this documentation we will focus on the elements that are relevant to load balancing, referred
to as Cluster Discovery Service, or CDS.</p>
</div>
</div>
<div class="sect2">
<h3 id="failure-detection-algorithms"><a class="anchor" href="#failure-detection-algorithms"></a><a class="link" href="#failure-detection-algorithms">Failure Detection Algorithms</a></h3>
<div class="paragraph">
<p>The default load balancer was designed to mitigate failures at both layer 4 (connection layer) and layer 7 (request
layer). It supports the following xDS compatible outlier detectors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Consecutive failures: ejects hosts that exceed the configured consecutive failures.</p>
</li>
<li>
<p>Success rate failure detection: statistical outlier ejection based on success rate.</p>
</li>
<li>
<p>Failure percentage outlier detection: ejects hosts with a failure rate that exceeds a fixed threshold.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In addition to the xDS defined outlier detectors default load balancer continues to support consecutive connection
failure detection with active probing: when a host is found to be unreachable it is marked as unhealthy until a new
connection can be established to the host. This probing is done outside the request path.</p>
</div>
</div>
<div class="sect2">
<h3 id="connection-selection-with-outlier-detectors"><a class="anchor" href="#connection-selection-with-outlier-detectors"></a><a class="link" href="#connection-selection-with-outlier-detectors">Connection Selection with Outlier Detectors</a></h3>
<div class="paragraph">
<p>Connection acquisition failures, request failures, and response latency are used to optimize traffic flows to avoid
unhealthy hosts and <em>bias</em> traffic to hosts with better response times in order to adjust to the observed capacity of
backends. The relationship is shown in the following diagram:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="_images/healthindicatordiagram.png" alt="Health Indicator Structure">
</div>
</div>
</div>
<div class="sect2">
<h3 id="connection-acquisition-workflow"><a class="anchor" href="#connection-acquisition-workflow"></a><a class="link" href="#connection-acquisition-workflow">Connection Acquisition Workflow</a></h3>
<div class="paragraph">
<p>By default, ServiceTalk attempts to minimize the connection load to each host. If the situation arises where there is
not an existing session capable of serving a request then connection acquisition can happen on the request path. The
session acquisition flow is roughly like this:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="_images/connectionacquisitiondiagram.png" alt="Connection Acquisition">
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="future-capabilities"><a class="anchor" href="#future-capabilities"></a><a class="link" href="#future-capabilities">Future Capabilities</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="weighted-load-balancing"><a class="anchor" href="#weighted-load-balancing"></a><a class="link" href="#weighted-load-balancing">Weighted Load Balancing</a></h3>
<div class="paragraph">
<p>Not all hosts are created equal! Due to different underlying hardware platforms, other tenants on the same host, or even
just a bad cache day, we often find that not all instances of a service have the same capacity. The P2C selection
algorithm can bias toward better performing hosts, but if the capacity of a backend is known it can be accounted for
explicitly. With <a href="https://github.com/apple/servicetalk/blob/0.42.62/servicetalk-client-api/src/main/java/io/servicetalk/client/api/ServiceDiscoverer.java">ServiceDiscoverer</a>
or control-plane support we can explicitly propagate weight information to ServiceTalk&#8217;s default load balancer. Adding
weight support to the host selection process will let users leverage this data.</p>
</div>
</div>
<div class="sect2">
<h3 id="priority-groups"><a class="anchor" href="#priority-groups"></a><a class="link" href="#priority-groups">Priority Groups</a></h3>
<div class="paragraph">
<p>Priority groups are another notion of weights in load balancing. Priority groups are a feature of the xDS protocol that
lets users partition backend instances into groups that have a relative priority to each other. The load balancer will
use hosts from as many priority groups as necessary to maintain a minimum specified number of healthy backends. A
common use case is to specify a primary destination, usually locally, for latency and transit cost reasons while
maintaining a set of backup destinations to use in the case of local disruptions.</p>
</div>
</div>
<div class="sect2">
<h3 id="subsetting"><a class="anchor" href="#subsetting"></a><a class="link" href="#subsetting">Subsetting</a></h3>
<div class="paragraph">
<p>When the sizes of two connected clusters grow the number of connections can become burdensome if the load balancer
maintains a full mesh network. Sub-setting can reduce the connection count by only creating connections to a subset of
backends. There are a number of ways to determine ths subset which can range from simple random sub-setting, which is
trivial to implement but suffers from load variance, to more intricate models.</p>
</div>
</div>
</div>
</div>
</article>
    </main>
</div>
<footer class="footer">
  <p>Copyright © <span class="footer-year"></span> Apple Inc. All rights reserved.</p>
  <script>
    document.querySelector('.footer-year').textContent = new Date().getFullYear();
  </script>
</footer>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </body>
</html>
