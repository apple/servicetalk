<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (17) -->
<title>GradientCapacityLimiterBuilder</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="declaration: package: io.servicetalk.capacity.limiter.api, class: GradientCapacityLimiterBuilder">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../script-dir/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
<script type="text/javascript" src="../../../../../script-dir/jquery-3.5.1.min.js"></script>
<script type="text/javascript" src="../../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var evenRowColor = "even-row-color";
var oddRowColor = "odd-row-color";
var tableTab = "table-tab";
var activeTableTab = "active-table-tab";
var pathtoroot = "../../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top">
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html#class">Help</a></li>
</ul>
</div>
<div class="sub-nav">
<div>
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li><a href="#nested-class-summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><label for="search-input">SEARCH:</label>
<input type="text" id="search-input" value="search" disabled="disabled">
<input type="reset" id="reset-button" value="reset" disabled="disabled">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">io.servicetalk.capacity.limiter.api</a></div>
<h1 title="Class GradientCapacityLimiterBuilder" class="title">Class GradientCapacityLimiterBuilder</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance">io.servicetalk.capacity.limiter.api.GradientCapacityLimiterBuilder</div>
</div>
<section class="class-description" id="class-description">
<hr>
<div class="type-signature"><span class="modifiers">public final class </span><span class="element-name type-name-label">GradientCapacityLimiterBuilder</span>
<span class="extends-implements">extends <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></span></div>
<div class="block">Builder for the <code>GradientCapacityLimiter</code> capacity limiter.</div>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<li>
<section class="nested-class-summary" id="nested-class-summary">
<h2>Nested Class Summary</h2>
<div class="caption"><span>Nested Classes</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Class</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>static interface&nbsp;</code></div>
<div class="col-second even-row-color"><code><a href="GradientCapacityLimiterBuilder.Observer.html" class="type-name-link" title="interface in io.servicetalk.capacity.limiter.api">GradientCapacityLimiterBuilder.Observer</a></code></div>
<div class="col-last even-row-color">
<div class="block">A state observer for Gradient <a href="CapacityLimiter.html" title="interface in io.servicetalk.capacity.limiter.api"><code>CapacityLimiter</code></a> to monitor internal state changes.</div>
</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel">
<div class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="GradientCapacityLimiterBuilder.html" title="class in io.servicetalk.capacity.limiter.api">GradientCapacityLimiterBuilder</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#backoffRatio(float,float)" class="member-name-link">backoffRatio</a><wbr>(float&nbsp;onDrop,
 float&nbsp;onLimit)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Defines the backoff ratios when certain conditions are met.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="CapacityLimiter.html" title="interface in io.servicetalk.capacity.limiter.api">CapacityLimiter</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#build()" class="member-name-link">build</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Builds a Gradient dynamic <a href="CapacityLimiter.html" title="interface in io.servicetalk.capacity.limiter.api"><code>CapacityLimiter</code></a> based on config options of this builder.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="GradientCapacityLimiterBuilder.html" title="class in io.servicetalk.capacity.limiter.api">GradientCapacityLimiterBuilder</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#headroom(java.util.function.BiFunction)" class="member-name-link">headroom</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/function/BiFunction.html" title="class or interface in java.util.function" class="external-link">BiFunction</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Double.html" title="class or interface in java.lang" class="external-link">Double</a>,<wbr><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Double.html" title="class or interface in java.lang" class="external-link">Double</a>,<wbr><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Double.html" title="class or interface in java.lang" class="external-link">Double</a>&gt;&nbsp;headroom)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">A function used to positively influence the new limit when the detected gradient is positive (i.e.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="GradientCapacityLimiterBuilder.html" title="class in io.servicetalk.capacity.limiter.api">GradientCapacityLimiterBuilder</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#limits(int,int,int)" class="member-name-link">limits</a><wbr>(int&nbsp;initial,
 int&nbsp;min,
 int&nbsp;max)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Define <code>initial</code>, <code>min</code> and <code>max</code> concurrency limits for this <a href="CapacityLimiter.html" title="interface in io.servicetalk.capacity.limiter.api"><code>CapacityLimiter</code></a>.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="GradientCapacityLimiterBuilder.html" title="class in io.servicetalk.capacity.limiter.api">GradientCapacityLimiterBuilder</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#limitUpdateInterval(java.time.Duration)" class="member-name-link">limitUpdateInterval</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/time/Duration.html" title="class or interface in java.time" class="external-link">Duration</a>&nbsp;duration)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">How often a new sampled RTT must be collected to update the concurrency limit.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="GradientCapacityLimiterBuilder.html" title="class in io.servicetalk.capacity.limiter.api">GradientCapacityLimiterBuilder</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#maxGradient(float)" class="member-name-link">maxGradient</a><wbr>(float&nbsp;maxPositiveGradient)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Defines the max gradient allowance per <a href="#limitUpdateInterval(java.time.Duration)"><code>sampling-interval</code></a>.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="GradientCapacityLimiterBuilder.html" title="class in io.servicetalk.capacity.limiter.api">GradientCapacityLimiterBuilder</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#minGradient(float)" class="member-name-link">minGradient</a><wbr>(float&nbsp;minGradient)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Defines the min gradient allowance per <a href="#limitUpdateInterval(java.time.Duration)"><code>sampling-interval</code></a>.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="GradientCapacityLimiterBuilder.html" title="class in io.servicetalk.capacity.limiter.api">GradientCapacityLimiterBuilder</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#name(java.lang.String)" class="member-name-link">name</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;name)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Defines a name for this <a href="CapacityLimiter.html" title="interface in io.servicetalk.capacity.limiter.api"><code>CapacityLimiter</code></a>.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="GradientCapacityLimiterBuilder.html" title="class in io.servicetalk.capacity.limiter.api">GradientCapacityLimiterBuilder</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#observer(io.servicetalk.capacity.limiter.api.GradientCapacityLimiterBuilder.Observer)" class="member-name-link">observer</a><wbr>(<a href="GradientCapacityLimiterBuilder.Observer.html" title="interface in io.servicetalk.capacity.limiter.api">GradientCapacityLimiterBuilder.Observer</a>&nbsp;observer)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">A <a href="GradientCapacityLimiterBuilder.Observer.html" title="interface in io.servicetalk.capacity.limiter.api"><code>observer</code></a> to consume the current state of this <a href="CapacityLimiter.html" title="interface in io.servicetalk.capacity.limiter.api"><code>CapacityLimiter</code></a> when
 state changes occur.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="GradientCapacityLimiterBuilder.html" title="class in io.servicetalk.capacity.limiter.api">GradientCapacityLimiterBuilder</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#suspendLimitDecrease(java.util.function.BiPredicate)" class="member-name-link">suspendLimitDecrease</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/function/BiPredicate.html" title="class or interface in java.util.function" class="external-link">BiPredicate</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link">Integer</a>,<wbr><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Double.html" title="class or interface in java.lang" class="external-link">Double</a>&gt;&nbsp;suspendLimitDec)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">A function to suspend the decrease of the limit when that is not consumed
 (e.g.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="GradientCapacityLimiterBuilder.html" title="class in io.servicetalk.capacity.limiter.api">GradientCapacityLimiterBuilder</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#suspendLimitIncrease(java.util.function.BiPredicate)" class="member-name-link">suspendLimitIncrease</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/function/BiPredicate.html" title="class or interface in java.util.function" class="external-link">BiPredicate</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link">Integer</a>,<wbr><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Double.html" title="class or interface in java.lang" class="external-link">Double</a>&gt;&nbsp;suspendLimitInc)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">A function to suspend the increase of the limit when that is not consumed
 (e.g.</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.lang.Object">Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#clone()" title="class or interface in java.lang" class="external-link">clone</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#equals(java.lang.Object)" title="class or interface in java.lang" class="external-link">equals</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#finalize()" title="class or interface in java.lang" class="external-link">finalize</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#getClass()" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#hashCode()" title="class or interface in java.lang" class="external-link">hashCode</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#notify()" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#notifyAll()" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#toString()" title="class or interface in java.lang" class="external-link">toString</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#wait()" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#wait(long)" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#wait(long,int)" title="class or interface in java.lang" class="external-link">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="name(java.lang.String)">
<h3>name</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="GradientCapacityLimiterBuilder.html" title="class in io.servicetalk.capacity.limiter.api">GradientCapacityLimiterBuilder</a></span>&nbsp;<span class="element-name">name</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>&nbsp;name)</span></div>
<div class="block">Defines a name for this <a href="CapacityLimiter.html" title="interface in io.servicetalk.capacity.limiter.api"><code>CapacityLimiter</code></a>.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>name</code> - the name to be used when building this <a href="CapacityLimiter.html" title="interface in io.servicetalk.capacity.limiter.api"><code>CapacityLimiter</code></a>.</dd>
<dt>Returns:</dt>
<dd><code>this</code>.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="limits(int,int,int)">
<h3>limits</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="GradientCapacityLimiterBuilder.html" title="class in io.servicetalk.capacity.limiter.api">GradientCapacityLimiterBuilder</a></span>&nbsp;<span class="element-name">limits</span><wbr><span class="parameters">(int&nbsp;initial,
 int&nbsp;min,
 int&nbsp;max)</span></div>
<div class="block">Define <code>initial</code>, <code>min</code> and <code>max</code> concurrency limits for this <a href="CapacityLimiter.html" title="interface in io.servicetalk.capacity.limiter.api"><code>CapacityLimiter</code></a>.
 The active concurrency will fluctuate between these limits starting from the <code>min</code> and never
 going beyond <code>max</code>.
 <p>
 The limit translates to a concurrency figure, e.g. how many requests can be in-flight simultaneously and
 doesn't represent a constant rate (i.e. has no notion of time).
 <p>
 The lower the <code>initial</code> or <code>min</code> are, the slower the ramp up will be, and the bigger it is the
 more aggressive the client will be, keep concurrently issuing <code>min</code> requests to meet this limit.
 <p>
 Min must always be less than max, and ideally max should be greater by 10x.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>initial</code> - The initial concurrency allowed, helps with faster start.</dd>
<dd><code>min</code> - The minimum concurrency allowed.</dd>
<dd><code>max</code> - The maximum concurrency allowed.</dd>
<dt>Returns:</dt>
<dd><code>this</code>.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="backoffRatio(float,float)">
<h3>backoffRatio</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="GradientCapacityLimiterBuilder.html" title="class in io.servicetalk.capacity.limiter.api">GradientCapacityLimiterBuilder</a></span>&nbsp;<span class="element-name">backoffRatio</span><wbr><span class="parameters">(float&nbsp;onDrop,
 float&nbsp;onLimit)</span></div>
<div class="block">Defines the backoff ratios when certain conditions are met.
 Ratios are used to alter the limit of the <a href="CapacityLimiter.html" title="interface in io.servicetalk.capacity.limiter.api"><code>CapacityLimiter</code></a> by the provided multiplier on different
 conditions as identified by their name.

 <p>
 The formula for the backoff ratio used is: <code>NewLimit = OldLimit * BackoffRatio</code>, always respecting the
 <code>min</code> and <code>max</code> values.

 <p>
 Both limits must be between 0 and 1 exclusively.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>onDrop</code> - The backoff ratio used to bring the limit down by that amount, when a request is dropped
 either by a server response identified as a rejection, or by a local timeout.</dd>
<dd><code>onLimit</code> - The backoff ratio used to bring the limit down by that amount, when the maximum limit is
 reached.</dd>
<dt>Returns:</dt>
<dd><code>this</code>.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="headroom(java.util.function.BiFunction)">
<h3>headroom</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="GradientCapacityLimiterBuilder.html" title="class in io.servicetalk.capacity.limiter.api">GradientCapacityLimiterBuilder</a></span>&nbsp;<span class="element-name">headroom</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/function/BiFunction.html" title="class or interface in java.util.function" class="external-link">BiFunction</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Double.html" title="class or interface in java.lang" class="external-link">Double</a>,<wbr><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Double.html" title="class or interface in java.lang" class="external-link">Double</a>,<wbr><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Double.html" title="class or interface in java.lang" class="external-link">Double</a>&gt;&nbsp;headroom)</span></div>
<div class="block">A function used to positively influence the new limit when the detected gradient is positive (i.e. &gt; 1.0).
 This can be used to grow the limit faster when the algorithm is being very conservative. Through testing
 a good headroom function can be the square root of the gradient (i.e. <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Math.html#sqrt(double)" title="class or interface in java.lang" class="external-link"><code>Math.sqrt(double)</code></a>).
 The input of the function is the newly calculated gradient, and the previous limit in this order.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>headroom</code> - An extra padding for the new limit if the algorithm is being very conservative.</dd>
<dt>Returns:</dt>
<dd><code>this</code>.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="limitUpdateInterval(java.time.Duration)">
<h3>limitUpdateInterval</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="GradientCapacityLimiterBuilder.html" title="class in io.servicetalk.capacity.limiter.api">GradientCapacityLimiterBuilder</a></span>&nbsp;<span class="element-name">limitUpdateInterval</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/time/Duration.html" title="class or interface in java.time" class="external-link">Duration</a>&nbsp;duration)</span></div>
<div class="block">How often a new sampled RTT must be collected to update the concurrency limit.
 This interval is part of the normal
 <a href="CapacityLimiter.html#tryAcquire(io.servicetalk.capacity.limiter.api.Classification,io.servicetalk.context.api.ContextMap)"><code>CapacityLimiter.tryAcquire(Classification, ContextMap)</code></a> flow, thus no external
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/Executor.html" title="class or interface in java.util.concurrent" class="external-link"><code>Executor</code></a> is used. The more traffic goes through the more accurate it will be.
 As a result this is not a <b>hard</b> deadline, but rather an at-least figure.
 <p>
 There is a hard min duration applied of <code>50ms</code> that can't be overridden. Any input less than that value
 will result in a <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link"><code>IllegalArgumentException</code></a>. That minimum interval was determined experimentally to
 avoid extreme adjustments of the limit without a cool off period.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>duration</code> - The duration between sampling an RTT value.</dd>
<dt>Returns:</dt>
<dd><code>this</code>.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="minGradient(float)">
<h3>minGradient</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="GradientCapacityLimiterBuilder.html" title="class in io.servicetalk.capacity.limiter.api">GradientCapacityLimiterBuilder</a></span>&nbsp;<span class="element-name">minGradient</span><wbr><span class="parameters">(float&nbsp;minGradient)</span></div>
<div class="block">Defines the min gradient allowance per <a href="#limitUpdateInterval(java.time.Duration)"><code>sampling-interval</code></a>.
 This helps push the limit upwards by not allowing quick drops, and it tends to maintain that higher limit.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>minGradient</code> - The minimum allowed gradient per <a href="#limitUpdateInterval(java.time.Duration)"><code>sampling
 interval</code></a>.</dd>
<dt>Returns:</dt>
<dd><code>this</code>.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="maxGradient(float)">
<h3>maxGradient</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="GradientCapacityLimiterBuilder.html" title="class in io.servicetalk.capacity.limiter.api">GradientCapacityLimiterBuilder</a></span>&nbsp;<span class="element-name">maxGradient</span><wbr><span class="parameters">(float&nbsp;maxPositiveGradient)</span></div>
<div class="block">Defines the max gradient allowance per <a href="#limitUpdateInterval(java.time.Duration)"><code>sampling-interval</code></a>.
 This helps limit how fast the limit can grow, allowing the peer to adjust to the change, before the
 limit grows out of control causing start-stop reactions (saw-tooth patterns in traffic).</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>maxPositiveGradient</code> - The maximum allowed gradient per <a href="#limitUpdateInterval(java.time.Duration)"><code>sampling
 interval</code></a>.</dd>
<dt>Returns:</dt>
<dd><code>this</code>.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="observer(io.servicetalk.capacity.limiter.api.GradientCapacityLimiterBuilder.Observer)">
<h3>observer</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="GradientCapacityLimiterBuilder.html" title="class in io.servicetalk.capacity.limiter.api">GradientCapacityLimiterBuilder</a></span>&nbsp;<span class="element-name">observer</span><wbr><span class="parameters">(<a href="GradientCapacityLimiterBuilder.Observer.html" title="interface in io.servicetalk.capacity.limiter.api">GradientCapacityLimiterBuilder.Observer</a>&nbsp;observer)</span></div>
<div class="block">A <a href="GradientCapacityLimiterBuilder.Observer.html" title="interface in io.servicetalk.capacity.limiter.api"><code>observer</code></a> to consume the current state of this <a href="CapacityLimiter.html" title="interface in io.servicetalk.capacity.limiter.api"><code>CapacityLimiter</code></a> when
 state changes occur. Useful to monitor the limit through logging or metrics, or just debugging.
 <p>
 <strong>It's expected that this <a href="GradientCapacityLimiterBuilder.Observer.html" title="interface in io.servicetalk.capacity.limiter.api"><code>GradientCapacityLimiterBuilder.Observer</code></a> is not going to block the thread that invokes it.</strong></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>observer</code> - The <a href="GradientCapacityLimiterBuilder.Observer.html" title="interface in io.servicetalk.capacity.limiter.api"><code>GradientCapacityLimiterBuilder.Observer</code></a> to inform about the current capacity and consumption
 of this <a href="CapacityLimiter.html" title="interface in io.servicetalk.capacity.limiter.api"><code>CapacityLimiter</code></a>.</dd>
<dt>Returns:</dt>
<dd><code>this</code>.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="suspendLimitIncrease(java.util.function.BiPredicate)">
<h3>suspendLimitIncrease</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="GradientCapacityLimiterBuilder.html" title="class in io.servicetalk.capacity.limiter.api">GradientCapacityLimiterBuilder</a></span>&nbsp;<span class="element-name">suspendLimitIncrease</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/function/BiPredicate.html" title="class or interface in java.util.function" class="external-link">BiPredicate</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link">Integer</a>,<wbr><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Double.html" title="class or interface in java.lang" class="external-link">Double</a>&gt;&nbsp;suspendLimitInc)</span></div>
<div class="block">A function to suspend the increase of the limit when that is not consumed
 (e.g. rate of requests isn't crossing it).
 This helps prevent the limit growing to infinite, and provides faster reaction when a reduction happens.
 Additionally, this works as a "blast-radius" concept, effectively limiting spontaneous traffic surges.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>suspendLimitInc</code> - The <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/function/BiPredicate.html" title="class or interface in java.util.function" class="external-link"><code>BiPredicate</code></a> that should return <code>true</code> when the limit
 should halt increasing based on current consumption (first argument as <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link"><code>Integer</code></a>) and current limit
 (second argument as <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Double.html" title="class or interface in java.lang" class="external-link"><code>Double</code></a>). Helper <code>API</code>
 to offer blast-radius type predicates.</dd>
<dt>Returns:</dt>
<dd><code>this</code>.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="suspendLimitDecrease(java.util.function.BiPredicate)">
<h3>suspendLimitDecrease</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="GradientCapacityLimiterBuilder.html" title="class in io.servicetalk.capacity.limiter.api">GradientCapacityLimiterBuilder</a></span>&nbsp;<span class="element-name">suspendLimitDecrease</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/function/BiPredicate.html" title="class or interface in java.util.function" class="external-link">BiPredicate</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link">Integer</a>,<wbr><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Double.html" title="class or interface in java.lang" class="external-link">Double</a>&gt;&nbsp;suspendLimitDec)</span></div>
<div class="block">A function to suspend the decrease of the limit when that is not consumed
 (e.g. rate of requests isn't crossing it).
 When the monitored RTT is considerably noisy (deviations &gt; 500ms) the limit tends to decrease faster,
 even when there is no significant utilization of it going on. This helps prevent the decrease,
 until the provided <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/function/Predicate.html" title="class or interface in java.util.function" class="external-link"><code>Predicate</code></a> toggles it.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>suspendLimitDec</code> - The <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/function/BiPredicate.html" title="class or interface in java.util.function" class="external-link"><code>BiPredicate</code></a> that should return <code>true</code> when the limit
 should halt decreasing based on current consumption (first argument as <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link"><code>Integer</code></a>) and current limit
 (second argument as <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Double.html" title="class or interface in java.lang" class="external-link"><code>Double</code></a>). Helper <code>API</code>
 to offer occupancy-factor type predicates.</dd>
<dt>Returns:</dt>
<dd><code>this</code>.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="build()">
<h3>build</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="CapacityLimiter.html" title="interface in io.servicetalk.capacity.limiter.api">CapacityLimiter</a></span>&nbsp;<span class="element-name">build</span>()</div>
<div class="block">Builds a Gradient dynamic <a href="CapacityLimiter.html" title="interface in io.servicetalk.capacity.limiter.api"><code>CapacityLimiter</code></a> based on config options of this builder.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>A dynamic <a href="CapacityLimiter.html" title="interface in io.servicetalk.capacity.limiter.api"><code>CapacityLimiter</code></a> based on the options of <code>this</code> builder.</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
</div>
</div>
</body>
</html>
