<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Blocking safe by default :: ServiceTalk Docs</title>
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" href="../../_/css/site.css">
<meta name="description" content="ServiceTalk is a JVM network application framework with APIs tailored to specific protocols (e.g. HTTP/1.x, HTTP/2.x, etc…​) and supports multiple programming paradigms.">
<meta name="keywords" content="servicetalk, java, reactive, reactive-streams, microservices, framework, http, http2, rpc, grpc, netty">
<link rel="stylesheet" href="../../_/css/site-extra.css">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-151504011-1"></script>
<script>function gtag(){dataLayer.push(arguments)};window.dataLayer=window.dataLayer||[];gtag('js',new Date());gtag('config','UA-151504011-1')</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <div class="navbar-item">
        <a href="https://github.com/apple/servicetalk">ServiceTalk</a>
        <span class="separator">//</span>
        <a href="../..">Docs</a>
      </div>
    </div>
  </nav>
</header>
<div class="main-wrapper">
    <div class="navigation-container"
      data-component="servicetalk-concurrent-api" data-version="SNAPSHOT">
    <aside class="navigation">
        <div class="panels">
            <div class="navigation-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html">Concurrent API</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <span class="nav-text">Concepts</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../servicetalk/SNAPSHOT/programming-paradigms.html">Programming Paradigms</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../servicetalk/SNAPSHOT/blocking-safe-by-default.html">Blocking safe by default</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../servicetalk/SNAPSHOT/evolve-to-async.html">Evolving to asynchronous</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../servicetalk/SNAPSHOT/async-context.html">Async context</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../servicetalk/SNAPSHOT/performance.html">Performance</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <span class="nav-text">Examples</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../../servicetalk-examples/SNAPSHOT/http/index.html">HTTP</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/SNAPSHOT/http/index.html#HelloWorld">Hello World</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/SNAPSHOT/http/index.html#Compression">Compression</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/SNAPSHOT/http/index.html#Debugging">Debugging</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/SNAPSHOT/http/index.html#Timeout">Timeout</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/SNAPSHOT/http/index.html#SerializationJson">Serialization: JSON</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/SNAPSHOT/http/index.html#SerializationProtobuf">Serialization: Protobuf</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/SNAPSHOT/http/index.html#JAXRS">JAX-RS</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/SNAPSHOT/http/index.html#MetaData">MetaData</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/SNAPSHOT/http/index.html#HTTP2">HTTP/2</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/SNAPSHOT/http/index.html#Mutual-TLS">Mutual TLS</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/SNAPSHOT/http/index.html#Observer">Observer</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/SNAPSHOT/http/index.html#OpenTracing">OpenTracing</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/SNAPSHOT/http/index.html#Redirects">Redirects</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/SNAPSHOT/http/index.html#Retries">Retries</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/SNAPSHOT/http/index.html#uds">Unix Domain Sockets</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/SNAPSHOT/http/service-composition.html">Service Composition</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../../servicetalk-examples/SNAPSHOT/grpc/index.html">gRPC</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/SNAPSHOT/grpc/index.html#HelloWorld">Hello World</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/SNAPSHOT/grpc/index.html#Compression">Compression</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/SNAPSHOT/grpc/index.html#Deadlines">Deadlines</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/SNAPSHOT/grpc/index.html#KeepAlive">Keep Alive</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/SNAPSHOT/grpc/index.html#Observer">Observer</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/SNAPSHOT/grpc/index.html#Health">Health Checking</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/SNAPSHOT/grpc/index.html#errors">Application Errors</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/SNAPSHOT/grpc/index.html#execution-strategy">Execution Strategy</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/SNAPSHOT/grpc/index.html#route-guide">Route Guide</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-examples/SNAPSHOT/grpc/index.html#protoc-options">Protoc Options</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <span class="nav-text">Concurrent API</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="asynchronous-primitives.html">Asynchronous primitives</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="blocking-safe-by-default.html">Blocking safe by default</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="blocking-implementation.html">Implementation details</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="async-context.html">Async Context</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="pitfalls.html">Concurrency Pitfalls</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../../servicetalk-http-api/SNAPSHOT/index.html">HTTP</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../servicetalk-http-api/SNAPSHOT/programming-paradigms.html">Programming paradigms</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../servicetalk-http-api/SNAPSHOT/blocking-safe-by-default.html">Blocking safe by default</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../servicetalk-http-api/SNAPSHOT/evolve-to-async.html">Evolving to asynchronous</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="../../servicetalk-http-router-jersey/SNAPSHOT/index.html">JAX-RS Router (Jersey)</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-http-router-jersey/SNAPSHOT/evolve-to-async.html">Evolving to asynchronous</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-http-security-jersey/SNAPSHOT/index.html">Security</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../servicetalk-data-jackson-jersey/SNAPSHOT/index.html">JSON (Jackson)</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../servicetalk-grpc-api/SNAPSHOT/index.html">gRPC</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../servicetalk-loadbalancer/SNAPSHOT/index.html">Load Balancing</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../servicetalk-client-api/SNAPSHOT/service-discovery.html">Service Discovery</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../servicetalk/SNAPSHOT/javadoc/index.html">Javadoc</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../servicetalk/SNAPSHOT/contributing.html">Contributing</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
            <div class="navigation-explore" data-panel="explore">
  <div class="context">
    <span class="title">Concurrent API</span>
    <span class="version">SNAPSHOT</span>
  </div>
  <ul class="components">
    <li class="component">
      <span class="title">Client API</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../servicetalk-client-api/SNAPSHOT/index.html">SNAPSHOT</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-client-api/0.42/index.html">0.42</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-client-api/0.41/index.html">0.41</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-client-api/0.40/index.html">0.40</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-client-api/0.39/index.html">0.39</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-client-api/0.38/index.html">0.38</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-client-api/0.37/index.html">0.37</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-client-api/0.36/index.html">0.36</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-client-api/0.35/index.html">0.35</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-client-api/0.34/index.html">0.34</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-client-api/0.33/index.html">0.33</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-client-api/0.32/index.html">0.32</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-client-api/0.31/index.html">0.31</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-client-api/0.30/index.html">0.30</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-client-api/0.29/index.html">0.29</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-client-api/0.28/index.html">0.28</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-client-api/0.27/index.html">0.27</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-client-api/0.26/index.html">0.26</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-client-api/0.25/index.html">0.25</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <span class="title">Concurrent API</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="index.html">SNAPSHOT</a>
        </li>
        <li class="version">
          <a href="../0.42/index.html">0.42</a>
        </li>
        <li class="version">
          <a href="../0.41/index.html">0.41</a>
        </li>
        <li class="version">
          <a href="../0.40/index.html">0.40</a>
        </li>
        <li class="version">
          <a href="../0.39/index.html">0.39</a>
        </li>
        <li class="version">
          <a href="../0.38/index.html">0.38</a>
        </li>
        <li class="version">
          <a href="../0.37/index.html">0.37</a>
        </li>
        <li class="version">
          <a href="../0.36/index.html">0.36</a>
        </li>
        <li class="version">
          <a href="../0.35/index.html">0.35</a>
        </li>
        <li class="version">
          <a href="../0.34/index.html">0.34</a>
        </li>
        <li class="version">
          <a href="../0.33/index.html">0.33</a>
        </li>
        <li class="version">
          <a href="../0.32/index.html">0.32</a>
        </li>
        <li class="version">
          <a href="../0.31/index.html">0.31</a>
        </li>
        <li class="version">
          <a href="../0.30/index.html">0.30</a>
        </li>
        <li class="version">
          <a href="../0.29/index.html">0.29</a>
        </li>
        <li class="version">
          <a href="../0.28/index.html">0.28</a>
        </li>
        <li class="version">
          <a href="../0.27/index.html">0.27</a>
        </li>
        <li class="version">
          <a href="../0.26/index.html">0.26</a>
        </li>
        <li class="version">
          <a href="../0.25/index.html">0.25</a>
        </li>
        <li class="version">
          <a href="../0.24/index.html">0.24</a>
        </li>
        <li class="version">
          <a href="../0.23/index.html">0.23</a>
        </li>
        <li class="version">
          <a href="../0.22/index.html">0.22</a>
        </li>
        <li class="version">
          <a href="../0.21/index.html">0.21</a>
        </li>
        <li class="version">
          <a href="../0.20/index.html">0.20</a>
        </li>
        <li class="version">
          <a href="../0.19/index.html">0.19</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Examples</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../servicetalk-examples/SNAPSHOT/index.html">SNAPSHOT</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-examples/0.42/index.html">0.42</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-examples/0.41/index.html">0.41</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-examples/0.40/index.html">0.40</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-examples/0.39/index.html">0.39</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-examples/0.38/index.html">0.38</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-examples/0.37/index.html">0.37</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-examples/0.36/index.html">0.36</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-examples/0.35/index.html">0.35</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-examples/0.34/index.html">0.34</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-examples/0.33/index.html">0.33</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-examples/0.32/index.html">0.32</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-examples/0.31/index.html">0.31</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-examples/0.30/index.html">0.30</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-examples/0.29/index.html">0.29</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-examples/0.28/index.html">0.28</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-examples/0.27/index.html">0.27</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-examples/0.26/index.html">0.26</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-examples/0.25/index.html">0.25</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-examples/0.24/index.html">0.24</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-examples/0.23/index.html">0.23</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-examples/0.22/index.html">0.22</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-examples/0.21/index.html">0.21</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-examples/0.20/index.html">0.20</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-examples/0.19/index.html">0.19</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">gRPC</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../servicetalk-grpc-api/SNAPSHOT/index.html">SNAPSHOT</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-grpc-api/0.42/index.html">0.42</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-grpc-api/0.41/index.html">0.41</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-grpc-api/0.40/index.html">0.40</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-grpc-api/0.39/index.html">0.39</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-grpc-api/0.38/index.html">0.38</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-grpc-api/0.37/index.html">0.37</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-grpc-api/0.36/index.html">0.36</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-grpc-api/0.35/index.html">0.35</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-grpc-api/0.34/index.html">0.34</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-grpc-api/0.33/index.html">0.33</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-grpc-api/0.32/index.html">0.32</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-grpc-api/0.31/index.html">0.31</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-grpc-api/0.30/index.html">0.30</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-grpc-api/0.29/index.html">0.29</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-grpc-api/0.28/index.html">0.28</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-grpc-api/0.27/index.html">0.27</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-grpc-api/0.26/index.html">0.26</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-grpc-api/0.25/index.html">0.25</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-grpc-api/0.24/index.html">0.24</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-grpc-api/0.23/index.html">0.23</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-grpc-api/0.22/index.html">0.22</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-grpc-api/0.21/index.html">0.21</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-grpc-api/0.20/index.html">0.20</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-grpc-api/0.19/index.html">0.19</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">HTTP</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../servicetalk-http-api/SNAPSHOT/index.html">SNAPSHOT</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-api/0.42/index.html">0.42</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-api/0.41/index.html">0.41</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-api/0.40/index.html">0.40</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-api/0.39/index.html">0.39</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-api/0.38/index.html">0.38</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-api/0.37/index.html">0.37</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-api/0.36/index.html">0.36</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-api/0.35/index.html">0.35</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-api/0.34/index.html">0.34</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-api/0.33/index.html">0.33</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-api/0.32/index.html">0.32</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-api/0.31/index.html">0.31</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-api/0.30/index.html">0.30</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-api/0.29/index.html">0.29</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-api/0.28/index.html">0.28</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-api/0.27/index.html">0.27</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-api/0.26/index.html">0.26</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-api/0.25/index.html">0.25</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-api/0.24/index.html">0.24</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-api/0.23/index.html">0.23</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-api/0.22/index.html">0.22</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-api/0.21/index.html">0.21</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-api/0.20/index.html">0.20</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-api/0.19/index.html">0.19</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">JAX-RS Router (Jersey)</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../servicetalk-http-router-jersey/SNAPSHOT/index.html">SNAPSHOT</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-router-jersey/0.42/index.html">0.42</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-router-jersey/0.41/index.html">0.41</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-router-jersey/0.40/index.html">0.40</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-router-jersey/0.39/index.html">0.39</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-router-jersey/0.38/index.html">0.38</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-router-jersey/0.37/index.html">0.37</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-router-jersey/0.36/index.html">0.36</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-router-jersey/0.35/index.html">0.35</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-router-jersey/0.34/index.html">0.34</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-router-jersey/0.33/index.html">0.33</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-router-jersey/0.32/index.html">0.32</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-router-jersey/0.31/index.html">0.31</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-router-jersey/0.30/index.html">0.30</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-router-jersey/0.29/index.html">0.29</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-router-jersey/0.28/index.html">0.28</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-router-jersey/0.27/index.html">0.27</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-router-jersey/0.26/index.html">0.26</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-router-jersey/0.25/index.html">0.25</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-router-jersey/0.24/index.html">0.24</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-router-jersey/0.23/index.html">0.23</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-router-jersey/0.22/index.html">0.22</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-router-jersey/0.21/index.html">0.21</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-router-jersey/0.20/index.html">0.20</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-router-jersey/0.19/index.html">0.19</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">JSON (Jackson)</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../servicetalk-data-jackson-jersey/SNAPSHOT/index.html">SNAPSHOT</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-data-jackson-jersey/0.42/index.html">0.42</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-data-jackson-jersey/0.41/index.html">0.41</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-data-jackson-jersey/0.40/index.html">0.40</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-data-jackson-jersey/0.39/index.html">0.39</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-data-jackson-jersey/0.38/index.html">0.38</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-data-jackson-jersey/0.37/index.html">0.37</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-data-jackson-jersey/0.36/index.html">0.36</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-data-jackson-jersey/0.35/index.html">0.35</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-data-jackson-jersey/0.34/index.html">0.34</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-data-jackson-jersey/0.33/index.html">0.33</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-data-jackson-jersey/0.32/index.html">0.32</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-data-jackson-jersey/0.31/index.html">0.31</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-data-jackson-jersey/0.30/index.html">0.30</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-data-jackson-jersey/0.29/index.html">0.29</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-data-jackson-jersey/0.28/index.html">0.28</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-data-jackson-jersey/0.27/index.html">0.27</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-data-jackson-jersey/0.26/index.html">0.26</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-data-jackson-jersey/0.25/index.html">0.25</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-data-jackson-jersey/0.24/index.html">0.24</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-data-jackson-jersey/0.23/index.html">0.23</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-data-jackson-jersey/0.22/index.html">0.22</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-data-jackson-jersey/0.21/index.html">0.21</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-data-jackson-jersey/0.20/index.html">0.20</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-data-jackson-jersey/0.19/index.html">0.19</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Load balancing</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../servicetalk-loadbalancer/SNAPSHOT/index.html">SNAPSHOT</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-loadbalancer/0.42/index.html">0.42</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-loadbalancer/0.41/index.html">0.41</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-loadbalancer/0.40/index.html">0.40</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-loadbalancer/0.39/index.html">0.39</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-loadbalancer/0.38/index.html">0.38</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-loadbalancer/0.37/index.html">0.37</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-loadbalancer/0.36/index.html">0.36</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-loadbalancer/0.35/index.html">0.35</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-loadbalancer/0.34/index.html">0.34</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-loadbalancer/0.33/index.html">0.33</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-loadbalancer/0.32/index.html">0.32</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-loadbalancer/0.31/index.html">0.31</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-loadbalancer/0.30/index.html">0.30</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-loadbalancer/0.29/index.html">0.29</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-loadbalancer/0.28/index.html">0.28</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-loadbalancer/0.27/index.html">0.27</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-loadbalancer/0.26/index.html">0.26</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-loadbalancer/0.25/index.html">0.25</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-loadbalancer/0.24/index.html">0.24</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-loadbalancer/0.23/index.html">0.23</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-loadbalancer/0.22/index.html">0.22</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-loadbalancer/0.21/index.html">0.21</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-loadbalancer/0.20/index.html">0.20</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Security</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../servicetalk-http-security-jersey/SNAPSHOT/index.html">SNAPSHOT</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-security-jersey/0.42/index.html">0.42</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-security-jersey/0.41/index.html">0.41</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-security-jersey/0.40/index.html">0.40</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-security-jersey/0.39/index.html">0.39</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-security-jersey/0.38/index.html">0.38</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-security-jersey/0.37/index.html">0.37</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-security-jersey/0.36/index.html">0.36</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-security-jersey/0.35/index.html">0.35</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-security-jersey/0.34/index.html">0.34</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-security-jersey/0.33/index.html">0.33</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-security-jersey/0.32/index.html">0.32</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-security-jersey/0.31/index.html">0.31</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-security-jersey/0.30/index.html">0.30</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-security-jersey/0.29/index.html">0.29</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-security-jersey/0.28/index.html">0.28</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-security-jersey/0.27/index.html">0.27</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-security-jersey/0.26/index.html">0.26</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-security-jersey/0.25/index.html">0.25</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-security-jersey/0.24/index.html">0.24</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-security-jersey/0.23/index.html">0.23</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-security-jersey/0.22/index.html">0.22</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-security-jersey/0.21/index.html">0.21</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-security-jersey/0.20/index.html">0.20</a>
        </li>
        <li class="version">
          <a href="../../servicetalk-http-security-jersey/0.19/index.html">0.19</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">ServiceTalk</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../servicetalk/SNAPSHOT/index.html">SNAPSHOT</a>
        </li>
        <li class="version">
          <a href="../../servicetalk/0.42/index.html">0.42</a>
        </li>
        <li class="version">
          <a href="../../servicetalk/0.41/index.html">0.41</a>
        </li>
        <li class="version">
          <a href="../../servicetalk/0.40/index.html">0.40</a>
        </li>
        <li class="version">
          <a href="../../servicetalk/0.39/index.html">0.39</a>
        </li>
        <li class="version">
          <a href="../../servicetalk/0.38/index.html">0.38</a>
        </li>
        <li class="version">
          <a href="../../servicetalk/0.37/index.html">0.37</a>
        </li>
        <li class="version">
          <a href="../../servicetalk/0.36/index.html">0.36</a>
        </li>
        <li class="version">
          <a href="../../servicetalk/0.35/index.html">0.35</a>
        </li>
        <li class="version">
          <a href="../../servicetalk/0.34/index.html">0.34</a>
        </li>
        <li class="version">
          <a href="../../servicetalk/0.33/index.html">0.33</a>
        </li>
        <li class="version">
          <a href="../../servicetalk/0.32/index.html">0.32</a>
        </li>
        <li class="version">
          <a href="../../servicetalk/0.31/index.html">0.31</a>
        </li>
        <li class="version">
          <a href="../../servicetalk/0.30/index.html">0.30</a>
        </li>
        <li class="version">
          <a href="../../servicetalk/0.29/index.html">0.29</a>
        </li>
        <li class="version">
          <a href="../../servicetalk/0.28/index.html">0.28</a>
        </li>
        <li class="version">
          <a href="../../servicetalk/0.27/index.html">0.27</a>
        </li>
        <li class="version">
          <a href="../../servicetalk/0.26/index.html">0.26</a>
        </li>
        <li class="version">
          <a href="../../servicetalk/0.25/index.html">0.25</a>
        </li>
        <li class="version">
          <a href="../../servicetalk/0.24/index.html">0.24</a>
        </li>
        <li class="version">
          <a href="../../servicetalk/0.23/index.html">0.23</a>
        </li>
        <li class="version">
          <a href="../../servicetalk/0.22/index.html">0.22</a>
        </li>
        <li class="version">
          <a href="../../servicetalk/0.21/index.html">0.21</a>
        </li>
        <li class="version">
          <a href="../../servicetalk/0.20/index.html">0.20</a>
        </li>
        <li class="version">
          <a href="../../servicetalk/0.19/index.html">0.19</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
        </div>
    </aside>
</div>
    <main class="main">
        <div class="toolbar" role="navigation">
  <button class="navigation-toggle"></button>
  <a href="../../servicetalk/SNAPSHOT/index.html" class="home-link"></a>
<nav class="crumbs" aria-label="breadcrumbs">
        <ul>
                <li class="crumb">Concurrent API</li>
                <li class="crumb"><a href="blocking-safe-by-default.html">Blocking safe by default</a></li>
        </ul>
</nav>
<div class="page-versions">
  <button class="versions-menu-toggle" title="Show other versions of page">SNAPSHOT</button>
  <div class="versions-menu">
    <a class="version is-current" href="blocking-safe-by-default.html">SNAPSHOT</a>
    <a class="version" href="../0.42/blocking-safe-by-default.html">0.42</a>
    <a class="version" href="../0.41/blocking-safe-by-default.html">0.41</a>
    <a class="version" href="../0.40/blocking-safe-by-default.html">0.40</a>
    <a class="version" href="../0.39/blocking-safe-by-default.html">0.39</a>
    <a class="version" href="../0.38/blocking-safe-by-default.html">0.38</a>
    <a class="version" href="../0.37/blocking-safe-by-default.html">0.37</a>
    <a class="version" href="../0.36/blocking-safe-by-default.html">0.36</a>
    <a class="version" href="../0.35/blocking-safe-by-default.html">0.35</a>
    <a class="version" href="../0.34/blocking-safe-by-default.html">0.34</a>
    <a class="version" href="../0.33/blocking-safe-by-default.html">0.33</a>
    <a class="version" href="../0.32/blocking-safe-by-default.html">0.32</a>
    <a class="version" href="../0.31/blocking-safe-by-default.html">0.31</a>
    <a class="version" href="../0.30/blocking-safe-by-default.html">0.30</a>
    <a class="version" href="../0.29/blocking-safe-by-default.html">0.29</a>
    <a class="version" href="../0.28/blocking-safe-by-default.html">0.28</a>
    <a class="version" href="../0.27/blocking-safe-by-default.html">0.27</a>
    <a class="version" href="../0.26/blocking-safe-by-default.html">0.26</a>
    <a class="version" href="../0.25/blocking-safe-by-default.html">0.25</a>
    <a class="version" href="../0.24/blocking-safe-by-default.html">0.24</a>
    <a class="version" href="../0.23/blocking-safe-by-default.html">0.23</a>
    <a class="version" href="../0.22/blocking-safe-by-default.html">0.22</a>
    <a class="version" href="../0.21/blocking-safe-by-default.html">0.21</a>
    <a class="version" href="../0.20/blocking-safe-by-default.html">0.20</a>
    <a class="version" href="../0.19/blocking-safe-by-default.html">0.19</a>
  </div>
</div>
</div>
        <article class="doc">
<h1>Blocking safe by default</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This document elaborates how asynchronous sources provide ways to offload. General philosophy of writing blocking code
while using ServiceTalk is explained <a href="../../servicetalk/SNAPSHOT/blocking-safe-by-default.html" class="page">here</a> and is a recommended read.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="execution-chain"><a class="anchor" href="#execution-chain"></a><a class="link" href="#execution-chain">Execution chain</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Any ServiceTalk asynchronous source (<code>Publisher</code>, <code>Single</code> and <code>Completable</code>) offers multiple operators that can be
applied to the source. Any instance of such a source and all the operators applied to it before it is subscribed, is
called an execution chain.</p>
</div>
<div class="sect2">
<h3 id="data-and-control-flow-in-an-execution-chain"><a class="anchor" href="#data-and-control-flow-in-an-execution-chain"></a><a class="link" href="#data-and-control-flow-in-an-execution-chain">Data and control flow in an execution chain</a></h3>
<div class="paragraph">
<p>The image below details the flow of data (<code>Subscriber</code> methods) and control (<code>Publisher</code> and <code>Subscription</code> methods)
messages. Invocations in either direction may be executed on an EventLoop thread and hence needs to be protected. In
case new asynchronous sources are generated/received inside operators, they follow the same model and hence are removed
for brevity.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/blocking-scenarios.svg" alt="Data and control flow in an execution chain">
</div>
</div>
<div class="paragraph">
<p>As shown in the above picture, there are inherently two directions (data and control) of information flow for an
execution chain and these
<a href="https://github.com/reactive-streams/reactive-streams-jvm/blob/v1.0.3/README.md#glossary">signals</a> can be triggered
in parallel.</p>
</div>
<div class="paragraph">
<p><strong>By default, in ServiceTalk, signals are not executed on an EventLoop thread, but instead executed using an
<a href="https://github.com/apple/servicetalk/blob/main/servicetalk-concurrent-api/src/main/java/io/servicetalk/concurrent/api/Executor.java">Executor</a>
provided by the application in the order they are received.</strong></p>
</div>
<div class="sect3">
<h4 id="implications"><a class="anchor" href="#implications"></a><a class="link" href="#implications">Implications</a></h4>
<div class="paragraph">
<p>The implication of the above approach is the following:</p>
</div>
<div class="paragraph">
<p><strong>Users can execute blocking code inside an execution chain, provided they are not waiting for another data or control
message in the same execution chain.</strong></p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="task-offloading"><a class="anchor" href="#task-offloading"></a><a class="link" href="#task-offloading">Task Offloading</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>ServiceTalk uses Netty for network I/O and Netty uses a fixed number of EventLoop threads for executing I/O operations.
The number of EventLoop threads correlates to the number of CPU cores and <strong>not</strong> to the number of requests. This is
because in many cases threads typically sit idle while waiting for I/O to complete. Sharing threads helps minimize
resource consumption and improves scalability. However, sharing threads for different requests means all control flow
for a single request will impact all other requests that share the same thread. If the control flow blocks the current
thread for a longer time period (aka "blocks the thread") (e.g. external I/O) this may negatively impact latency and
throughput. One approach to ensure I/O thread availability is to carefully limit the scope of work done by I/O threads
and, whenever practical, delegate all other necessary tasks that are not related to I/O to some other thread. Moving
tasks from I/O threads to other threads is called “offloading” and is a core technique used by ServiceTalk.</p>
</div>
<div class="paragraph">
<p>Offloading is used for two purposes within ServiceTalk; firstly for the
execution needed for the handling of asynchronous events, aka
<a href="https://github.com/reactive-streams/reactive-streams-jvm/blob/v1.0.3/README.md#glossary">Signals</a>,
and secondly when handling asynchronous events, protecting scarce resources from being monopolized by blocking,
untrusted or expensive application code. Asynchronous execution requires offloading – the initiating calling thread
is not available. The use of protective offloading, where offloading is used for avoid resource monopolization, is a
practical consideration, but just as necessary for reliable and predictable operation.</p>
</div>
<div class="paragraph">
<p>ServiceTalk will, by default, execute most application code on threads other than the Netty I/O threads.
For most invocations of application code, if the application developer knows that their code cannot block and always
executes quickly in near constant time they can request that ServiceTalk not offload their code. This will improve
application performance by reducing latency and overhead. Requests to not offload will be honored by ServiceTalk if all
the other components in the same execution path have also opted out of offloading. See
<a href="../../servicetalk/SNAPSHOT/blocking-safe-by-default.html#execution-strategy" class="page">Execution Strategy</a>
for more information on how components may specify their offloading requirements. As a last resort, tasks may also be
queued to be performed as threads are available.</p>
</div>
<div class="paragraph">
<p>ServiceTalk is designed to be fully asynchronous except where the API provides explicit blocking behavior <a href="../../servicetalk/SNAPSHOT/programming-paradigms.html" class="page">as a convenience</a>.</p>
</div>
<div class="paragraph">
<p>ServiceTalk uses a task based approach for offloading, using <code>Executor</code> in the standard "fire-and-forget" way to run the
offloaded tasks. Often the <code>Executor</code> has a pool of threads, possibly unbounded, and tasks are run using whatever thread
is available. In particular, different threads may be used for each task executed and code running in tasks cannot
depend upon a consistent thread being used for invoking program logic. This approach is generally the most scalable
because it makes the best utilization of threads. If it is necessary to share state between tasks then
`<a href="https://github.com/apple/servicetalk/blob/main/servicetalk-context-api/src/main/java/io/servicetalk/context/api/ContextMap.java">ContextMap</a>`s
can be used.</p>
</div>
<div class="paragraph">
<p>If the default ServiceTalk offloading has been disabled then user code may still wish to offload execution to a
different <code>Executor</code> in specific cases. ServiceTalk provides reactive operators for explicitly offloading both
<code>subscribe</code> and <code>Subscriber</code> via the <code>subscribeOn(executor)</code> operator as well as the <code>Subscription</code> methods via the
<code>publishOn(executor)</code> operator. These operators will unconditionally offload to the specified <code>Executor</code>. Additional,
conditional offloading operators; <code>subscribeOn(executor, predicate)</code> and <code>publishOn(executor, predicate)</code> are also
available.</p>
</div>
<div class="sect2">
<h3 id="publishon-example"><a class="anchor" href="#publishon-example"></a><a class="link" href="#publishon-example"><code>publishOn()</code> Example</a></h3>
<div class="paragraph">
<p>Using the <code>publishOn(executor)</code> operator allows processing of signals related to the source content on a different
thread than is generating the content. It is the most common form of offloading used as it relates to the data path,
specifically the <code>Subscription</code> methods.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Collection&lt;Integer&gt; result = Publisher.range(1, 10) <i class="conum" data-value="2"></i><b>(2)</b> <i class="conum" data-value="5"></i><b>(5)</b>
        .map(element -&gt; element)  // non-offloaded NO-OP
        .publishOn(publishExecutor)  <i class="conum" data-value="4"></i><b>(4)</b>
        .map(element -&gt; element)  // offloaded NO-OP
        .toFuture()  <i class="conum" data-value="3"></i><b>(3)</b>
        .get();  <i class="conum" data-value="1"></i><b>(1)</b> <i class="conum" data-value="6"></i><b>(6)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>toFuture()</code> begins by calling <code>subscribe(Subscriber)</code>. Executing on the calling thread, execution flows up
the operator chain towards the source; <code>map</code> &#8594; <code>publishOn</code> &#8594; <code>map</code> &#8594; <code>Publisher.range(1, 10)</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Still executing on the calling thread, <code>Range</code> will call <code>Subscriber.onSubscribe(Subscription)</code> on the
<code>Subscriber</code>. This flows back down the operator chain, <code>Range</code> &#8594; <code>map</code> &#8594; <code>publishOn</code> (offloads on to <code>publishExecutor</code>
thread) &#8594; <code>map</code> &#8594; <code>toFuture</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <code>onSubscribe(Subscription)</code> method of <code>toFuture()</code>&#xfeff;'s <code>Subscriber</code> will call
<code>Subscription.request(Long.MAX_VALUE)</code>. Execution flows up the operator chain towards the source;
<code>map</code> &#8594; <code>publishOn</code> &#8594; <code>map</code> &#8594; <code>Range</code>. <code>Range</code> will publish synchronously via <code>onNext(element)</code> nine items, the
integers &#8220;1&#8221; through &#8220;9&#8221;.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Each <code>onNext</code> flows down the operator chain, <code>Range</code> &#8594; <code>map</code> &#8594; <code>publishOn</code> (offloads on to <code>publishExecutor</code>
thread) &#8594; <code>map</code> &#8594; <code>toFuture</code> where the element is collected for the result. For each offloaded item a thread of
<code>publishExecutor</code> will be used for executing the second <code>map</code> operator and final collect operation.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>After all items, <code>Range</code> sends the terminal <code>onComplete()</code> signal synchronously which flows down the operator chain,
<code>Range</code> &#8594; <code>map &#8594; `publishOn</code> (offloads on to <code>publishExecutor</code> thread) &#8594; <code>map</code> &#8594; <code>toFuture</code> and will complete the
<code>Future</code> with the integer collection result.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>The calling thread will wait at <code>get()</code> for the <code>Future</code> result to be asynchronously completed.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="subscribeon-example"><a class="anchor" href="#subscribeon-example"></a><a class="link" href="#subscribeon-example"><code>subscribeOn()</code> Example</a></h3>
<div class="paragraph">
<p>Using the <code>subscribeOn(executor)</code> operator allows processing of the subscription and demand on a specific thread. Using
the <code>subscribeOn(executor)</code> operator is necessary if the thread doing the <code>subscribe</code> or interacting with the
<code>Subscription</code> is sensitive to blocking, for example, an EventLoop thread.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Collection&lt;Integer&gt; result = Publisher.range(1, 10) <i class="conum" data-value="2"></i><b>(2)</b> <i class="conum" data-value="4"></i><b>(4)</b>
        .map(element -&gt; element)  // NO-OP
        .subscribeOn(subscribeExecutor)
        .toFuture() <i class="conum" data-value="1"></i><b>(1)</b> <i class="conum" data-value="3"></i><b>(3)</b> <i class="conum" data-value="5"></i><b>(5)</b>
        .get(); <i class="conum" data-value="6"></i><b>(6)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>toFuture()</code> will do a <code>subscribe(Subscriber)</code>. This flows up the operator chain toward the source;
<code>subscribeOn</code> (offload onto <code>subscribeExecutor</code> thread) &#8594; <code>map</code> &#8594; <code>Range</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Still on a thread from <code>subscribeExecutor</code> <code>Range</code> will call <code>Subscriber.onSubscribe(Subscription)</code> on the
<code>Subscriber</code>. This flows back down the operator chain, <code>Range</code> &#8594; <code>map</code> &#8594; <code>subscribeOn</code> &#8594; <code>toFuture</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Still on the`subscribeExecutor` thread, <code>toFuture()&#8217;s `onSubscribe(Subscription)</code> call
<code>Subscription.request(Long.MAX_VALUE)</code>. This flows up the operator chain, <code>subscribeOn</code> (offloads again onto another
<code>subscribeExecutor</code> thread) &#8594; <code>map</code> &#8594; <code>Range</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Still on thread from the second offload to <code>subscribeExecutor</code>, <code>Range</code> ` will publish synchronously via
<code>onNext(element)</code> nine items, the integers &#8220;1&#8221; through &#8220;9&#8221;. Each <code>onNext</code> flows back down the operator chain,
<code>Range</code> &#8594; <code>map</code> &#8594; <code>subscribeOn</code> &#8594; <code>toFuture</code> where the element is collected for the result.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Still on thread from the second offload to <code>subscribeExecutor</code>, after all items, <code>Range</code> will call <code>onComplete</code>.
When the <code>toFuture()</code> <code>Subscriber</code> receives the <code>onComplete()</code> signal it will complete the <code>Future</code> with the integer
collection result.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>The calling thread will wait at <code>get()</code> for the <code>Future</code> result to be asynchronously completed.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="publishonsubscribeon-detailed-example"><a class="anchor" href="#publishonsubscribeon-detailed-example"></a><a class="link" href="#publishonsubscribeon-detailed-example">publishOn()/subscribeOn() Detailed Example</a></h3>
<div class="paragraph">
<p>These examples can be expanded to demonstrate the offloading behavior directly. The expanded example extends the NO-OP
<code>map</code> implementations to reveal the active thread during their execution. To show the active thread at the other
points described in the callouts the expanded example also adds <code>whenOnSubscribe</code>, <code>whenRequest</code>, <code>liftSync</code> and
<code>whenFinally</code> operations in the operator chain. The output of the example shows the thread used for executing each of
the operators, while the specialized operators provide examples of how you might use them to debug your own programs.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Collection&lt;?&gt; result = Publisher.range(1, 3)
        .map(element -&gt; {
            System.out.println("\nPublish starts on " + Thread.currentThread() + " Received : " + element);
            return element;
        })
        .whenOnSubscribe(subscription -&gt; {
            System.out.println("\nonSubscribe starts on " + Thread.currentThread());
        })
        .publishOn(publishExecutor)
        .map(element -&gt; {
            System.out.println("\nPublish offloaded to " + Thread.currentThread() + " Received : " + element);
            return element;
        })
        .whenRequest(request -&gt; {
            System.out.println("\nrequest(" + request + ") offloaded to " + Thread.currentThread());
        })
        .liftSync(subscriber -&gt; {
            System.out.println("\nSubscribe offloaded to " + Thread.currentThread());
            return subscriber;
        })
        .subscribeOn(subscribeExecutor)
        .liftSync(subscriber -&gt; {
            System.out.println("\nSubscribe begins on " + Thread.currentThread());
            return subscriber;
        })
        .whenOnSubscribe(subscription -&gt; {
            System.out.println("\nonSubscribe offloaded to " + Thread.currentThread());
        })
        .whenRequest(request -&gt; {
            System.out.println("\nrequest(" + request + ") starts on " + Thread.currentThread());
        })
        .whenFinally(new TerminalSignalConsumer() {
            @Override
            public void onComplete() {
                System.out.println("\ncomplete on " + Thread.currentThread());
            }

            @Override
            public void onError(final Throwable throwable) {
                System.out.println("\nerror (" + throwable + ") on " + Thread.currentThread());
            }

            @Override
            public void cancel() {
                System.out.println("\ncancel on " + Thread.currentThread());
            }
        })
        .toFuture()
        .get();</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the default ServiceTalk offloading has been disabled then user code may still wish to offload execution to a
different <code>Executor</code> in specific cases. ServiceTalk provides reactive operators for explicitly offloading both
<code>subscribe</code> and <code>Subscriber</code> via the <code>subscribeOn(executor)</code> operator as well as the <code>Subscription</code> methods via the
<code>publishOn(executor)</code> operator. These operators will unconditionally offload to the specified <code>Executor</code>. Additional,
conditional offloading operators; <code>subscribeOn(executor, predicate)</code> and <code>publishOn(executor, predicate)</code> are also
available.</p>
</div>
</div>
<div class="sect2">
<h3 id="publishon-example-2"><a class="anchor" href="#publishon-example-2"></a><a class="link" href="#publishon-example-2"><code>publishOn()</code> Example</a></h3>
<div class="paragraph">
<p>Using the <code>publishOn(executor)</code> operator allows processing of signals related to the source content on a different
thread than is generating the content. It is the most common form of offloading used as it relates to the data path,
specifically the <code>Subscription</code> methods.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Collection&lt;Integer&gt; result = Publisher.range(1, 10) <i class="conum" data-value="2"></i><b>(2)</b> <i class="conum" data-value="5"></i><b>(5)</b>
        .map(element -&gt; element)  // non-offloaded NO-OP
        .publishOn(publishExecutor)  <i class="conum" data-value="4"></i><b>(4)</b>
        .map(element -&gt; element)  // offloaded NO-OP
        .toFuture()  <i class="conum" data-value="3"></i><b>(3)</b>
        .get();  <i class="conum" data-value="1"></i><b>(1)</b> <i class="conum" data-value="6"></i><b>(6)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>toFuture()</code> begins by calling <code>subscribe(Subscriber)</code>. Executing on the calling thread, execution flows up
the operator chain towards the source; <code>map</code> &#8594; <code>publishOn</code> &#8594; <code>map</code> &#8594; <code>Publisher.range(1, 10)</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Still executing on the calling thread, <code>Range</code> will call <code>Subscriber.onSubscribe(Subscription)</code> on the
<code>Subscriber</code>. This flows back down the operator chain, <code>Range</code> &#8594; <code>map</code> &#8594; <code>publishOn</code> (offloads on to <code>publishExecutor</code>
thread) &#8594; <code>map</code> &#8594; <code>toFuture</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <code>onSubscribe(Subscription)</code> method of <code>toFuture()</code>&#xfeff;'s <code>Subscriber</code> will call
<code>Subscription.request(Long.MAX_VALUE)</code>. Execution flows up the operator chain towards the source;
<code>map</code> &#8594; <code>publishOn</code> &#8594; <code>map</code> &#8594; <code>Range</code>. <code>Range</code> will publish synchronously via <code>onNext(element)</code> nine items, the
integers &#8220;1&#8221; through &#8220;9&#8221;.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Each <code>onNext</code> flows down the operator chain, <code>Range</code> &#8594; <code>map</code> &#8594; <code>publishOn</code> (offloads on to <code>publishExecutor</code>
thread) &#8594; <code>map</code> &#8594; <code>toFuture</code> where the element is collected for the result. For each offloaded item a thread of
<code>publishExecutor</code> will be used for executing the second <code>map</code> operator and final collect operation.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>After all items, <code>Range</code> sends the terminal <code>onComplete()</code> signal synchronously which flows down the operator chain,
<code>Range</code> &#8594; <code>map &#8594; `publishOn</code> (offloads on to <code>publishExecutor</code> thread) &#8594; <code>map</code> &#8594; <code>toFuture</code> and will complete the
<code>Future</code> with the integer collection result.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>The calling thread will wait at <code>get()</code> for the <code>Future</code> result to be asynchronously completed.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="subscribeon-example-2"><a class="anchor" href="#subscribeon-example-2"></a><a class="link" href="#subscribeon-example-2"><code>subscribeOn()</code> Example</a></h3>
<div class="paragraph">
<p>Using the <code>subscribeOn(executor)</code> operator allows processing of the subscription and demand on a specific thread. Using
the <code>subscribeOn(executor)</code> operator generally requires an understanding of the behavior of the source; using a
different source may change the need for offloading. <code>subscribeOn(executor)</code> is used less frequently than
<code>publishOn(executor)</code> but is useful when it is necessary to offload the control path; the <code>subscribe</code> method or
<code>Subscription</code> methods.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Collection&lt;Integer&gt; result = Publisher.range(1, 10) <i class="conum" data-value="2"></i><b>(2)</b> <i class="conum" data-value="4"></i><b>(4)</b>
        .map(element -&gt; element)  // NO-OP
        .subscribeOn(subscribeExecutor)
        .toFuture() <i class="conum" data-value="1"></i><b>(1)</b> <i class="conum" data-value="3"></i><b>(3)</b> <i class="conum" data-value="5"></i><b>(5)</b>
        .get(); <i class="conum" data-value="6"></i><b>(6)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>toFuture()</code> will do a <code>subscribe(Subscriber)</code>. This flows up the operator chain toward the source;
<code>subscribeOn</code> (offload onto <code>subscribeExecutor</code> thread) &#8594; <code>map</code> &#8594; <code>Range</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Still on a thread from <code>subscribeExecutor</code> <code>Range</code> will call <code>Subscriber.onSubscribe(Subscription)</code> on the
<code>Subscriber</code>. This flows back down the operator chain, <code>Range</code> &#8594; <code>map</code> &#8594; <code>subscribeOn</code> &#8594; <code>toFuture</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Still on the`subscribeExecutor` thread, <code>toFuture()&#8217;s `onSubscribe(Subscription)</code> call
<code>Subscription.request(Long.MAX_VALUE)</code>. This flows up the operator chain, <code>subscribeOn</code> (offloads again onto another
<code>subscribeExecutor</code> thread) &#8594; <code>map</code> &#8594; <code>Range</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Still on thread from the second offload to <code>subscribeExecutor</code>, <code>Range</code> ` will publish synchronously via
<code>onNext(element)</code> nine items, the integers &#8220;1&#8221; through &#8220;9&#8221;. Each <code>onNext</code> flows back down the operator chain,
<code>Range</code> &#8594; <code>map</code> &#8594; <code>subscribeOn</code> &#8594; <code>toFuture</code> where the element is collected for the result.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Still on thread from the second offload to <code>subscribeExecutor</code>, after all items, <code>Range</code> will call <code>onComplete</code>.
When the <code>toFuture()</code> <code>Subscriber</code> receives the <code>onComplete()</code> signal it will complete the <code>Future</code> with the integer
collection result.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>The calling thread will wait at <code>get()</code> for the <code>Future</code> result to be asynchronously completed.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="publishonsubscribeon-detailed-example-2"><a class="anchor" href="#publishonsubscribeon-detailed-example-2"></a><a class="link" href="#publishonsubscribeon-detailed-example-2">publishOn()/subscribeOn() Detailed Example</a></h3>
<div class="paragraph">
<p>These examples can be expanded to demonstrate the offloading behavior directly. The expanded example extends the NO-OP
<code>map</code> implementations to reveal the active thread during their execution. To show the active thread at the other
points described in the callouts the expanded example also adds <code>whenOnSubscribe</code>, <code>whenRequest</code>, <code>liftSync</code> and
<code>whenFinally</code> operations in the operator chain. The output of the example shows the thread used for executing each of
the operators, while the specialized operators provide examples of how you might use them to debug your own programs.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Collection&lt;?&gt; result = Publisher.range(1, 3)
        .map(element -&gt; {
            System.out.println("\nPublish starts on " + Thread.currentThread() + " Received : " + element);
            return element;
        })
        .whenOnSubscribe(subscription -&gt; {
            System.out.println("\nonSubscribe starts on " + Thread.currentThread());
        })
        .publishOn(publishExecutor)
        .map(element -&gt; {
            System.out.println("\nPublish offloaded to " + Thread.currentThread() + " Received : " + element);
            return element;
        })
        .whenRequest(request -&gt; {
            System.out.println("\nrequest(" + request + ") offloaded to " + Thread.currentThread());
        })
        .liftSync(subscriber -&gt; {
            System.out.println("\nSubscribe offloaded to " + Thread.currentThread());
            return subscriber;
        })
        .subscribeOn(subscribeExecutor)
        .liftSync(subscriber -&gt; {
            System.out.println("\nSubscribe begins on " + Thread.currentThread());
            return subscriber;
        })
        .whenOnSubscribe(subscription -&gt; {
            System.out.println("\nonSubscribe offloaded to " + Thread.currentThread());
        })
        .whenRequest(request -&gt; {
            System.out.println("\nrequest(" + request + ") starts on " + Thread.currentThread());
        })
        .whenFinally(new TerminalSignalConsumer() {
            @Override
            public void onComplete() {
                System.out.println("\ncomplete on " + Thread.currentThread());
            }

            @Override
            public void onError(final Throwable throwable) {
                System.out.println("\nerror (" + throwable + ") on " + Thread.currentThread());
            }

            @Override
            public void cancel() {
                System.out.println("\ncancel on " + Thread.currentThread());
            }
        })
        .toFuture()
        .get();</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="implementation"><a class="anchor" href="#implementation"></a><a class="link" href="#implementation">Implementation</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>In order to use ServiceTalk&#8217;s blocking support feature, one does not need to know about implementation details and the
above information is sufficient. However, if you are developing some operators in ServiceTalk or are just curious,
<a href="blocking-implementation.html" class="page">blocking-implementation.adoc</a> describes the design.</p>
</div>
</div>
</div>
</article>
    </main>
</div>
<footer class="footer">
  <p></p>
</footer>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </body>
</html>
